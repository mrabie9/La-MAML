python3 main.py $IQ --model agem --expt_name all_agem --n_memories 200 --batch_size 128 --n_epochs 30 
                    --lr 0.03 --glances 1 --memory_strength 0.5   --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3 

python3 main.py $IQ --model anml --expt_name all_anml --batch_size 128 --n_epochs 50 
                    --lr 0.001 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model eralg4 --expt_name all_eralg4 --memories 200 --batch_size 128 --n_epochs 50 --replay_batch_size 64 
                     --lr 0.03 --glances 1   --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model eralg4 --expt_name all_eralg4 --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --opt_lr 0.1 --alpha_init 0.1 --glances 1  --increment 5 
                     --cifar_batches 5 --learn_lr --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model icarl --expt_name all_icarl --n_memories 200 --batch_size 128 --n_epochs 50 
                    --lr 0.03 --glances 1 --memory_strength 1.0  --increment 5 
                    --log_every 3125 --class_order random  --samples_per_task 2500 
                    --seed $SEED --grad_clip_norm 5.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model gem --expt_name all_gem --n_memories 200 --batch_size 128 --n_epochs 50 
                    --lr 0.03 --glances 1 --memory_strength 0.5   --increment 5 
                    --log_every 3125 --class_order random --samples_per_task 2500 
                    --seed $SEED --grad_clip_norm 5.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model meralg1 --expt_name all_meralg1 --batch_size 128 --memories 200 --replay_batch_size 64 
                    --lr 0.1 --beta 0.1 --gamma 1.0 --batches_per_example 10  --increment 5 
                    --log_every 3125 --grad_clip_norm 10.0 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model ewc --expt_name all_ewc --batch_size 128 --n_epochs 50 
                    --lr 0.03 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 25.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model lwf --expt_name all_lwf --batch_size 128 --n_epochs 50 
                    --lr 0.001 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 5.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model packnet --expt_name all_packnet --batch_size 128 --n_epochs 50 
                    --lr 0.01 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 5.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model rwalk --expt_name all_rwalk --batch_size 128 --n_epochs 50 
                    --lr 0.001 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 25.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model si --expt_name all_si --batch_size 128 --n_epochs 50 
                    --lr 0.001 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 25.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model hat --expt_name all_hat --batch_size 128 --n_epochs 50 
                    --lr 0.0005 --gamma 0.75 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 10.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model ctn --expt_name all_ctn --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --lr 0.03 --glances 1 --increment 5 
                    --ctn_n_memories 200 --ctn_lr 0.01 --ctn_beta 0.05 --ctn_inner_steps 2 --ctn_n_meta 2 
                    --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model er_ring --expt_name all_erring --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --lr 0.03 --glances 1 --increment 5 
                    --bcl_n_memories 200 --bcl_temperature 2.0 --bcl_memory_strength 1.0 --bcl_inner_steps 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model ucl_bresnet --expt_name all_ucl_bresnet --batch_size 64 --n_epochs 50 
                    --lr 0.001 --glances 1 --increment 5 
                    --log_every 3125 --class_order random 
                    --seed $SEED --grad_clip_norm 10.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model meta-bgd --expt_name all_meta-bgd --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --alpha_init 0.1 --glances 1  --increment 5 
                    --cifar_batches 3 --log_every 3125 --second_order --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3 --xav_init  --std_init 0.02 --mean_eta 50. --train_mc_iters 2

python3 main.py $IQ --model lamaml_cifar --expt_name all_lamaml --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --opt_lr 0.25 --alpha_init 0.1 --opt_wt 0.1 --glances 1  --increment 5 
                    --cifar_batches 5 --learn_lr --log_every 3125 --second_order --class_order random 
                    --seed $SEED --grad_clip_norm 1.0 --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model lamaml_cifar --expt_name all_lamaml_sync --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --opt_lr 0.35 --alpha_init 0.1 --opt_wt 0.1 --glances 1  --increment 5 
                    --cifar_batches 5 --learn_lr --sync_update --log_every 3125 --second_order --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

python3 main.py $IQ --model lamaml_cifar --expt_name all_cmaml --memories 200 --batch_size 128 --replay_batch_size 64 --n_epochs 50 
                    --opt_lr 0.35 --alpha_init 0.075 --opt_wt 0.075 --glances 1  --increment 5 
                    --cifar_batches 5 --sync_update --log_every 3125 --second_order --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3

Logging IQ experiment suite to logs/iq_experiments/run_20251202_163154.log
Running model:  agem
Set seed 0
Loaded task0.npz: Unique train labels: [2 3 5 7 8]
Loaded task0.npz: Remapped labels: [0 1 2 3 4]
Loaded task1.npz: Unique train labels: [0 1 4 6 9]
Loaded task1.npz: Remapped labels: [5 6 7 8 9]
n_outputs: 10 	n_tasks: 2
True
Model device: cuda:0
---- Eval at Epoch 0: [0.046825396825396826, 0.15912698412698412] ----
Task 0 Epoch 1/30 | Loss 1.5561 | Train Acc 0.2750 | Val Acc 0.0468
Task 0 Epoch 2/30 | Loss 1.3727 | Train Acc 0.3878 | Val Acc 0.0468
Task 0 Epoch 3/30 | Loss 1.0459 | Train Acc 0.5208 | Val Acc 0.0468
Task 0 Epoch 4/30 | Loss 0.8576 | Train Acc 0.5760 | Val Acc 0.0468
Task 0 Epoch 5/30 | Loss 0.7467 | Train Acc 0.6256 | Val Acc 0.0468
Task 0 Epoch 6/30 | Loss 0.6734 | Train Acc 0.6415 | Val Acc 0.0468
Task 0 Epoch 7/30 | Loss 0.6295 | Train Acc 0.6684 | Val Acc 0.0468
Task 0 Epoch 8/30 | Loss 0.5976 | Train Acc 0.6837 | Val Acc 0.0468
Task 0 Epoch 9/30 | Loss 0.5742 | Train Acc 0.6855 | Val Acc 0.0468
Task 0 Epoch 10/30 | Loss 0.5497 | Train Acc 0.7055 | Val Acc 0.0468
---- Eval at Epoch 10: [0.719047619047619, 0.0] ----
Task 0 Epoch 11/30 | Loss 0.5321 | Train Acc 0.7158 | Val Acc 0.7190
Task 0 Epoch 12/30 | Loss 0.5194 | Train Acc 0.7181 | Val Acc 0.7190
Task 0 Epoch 13/30 | Loss 0.5020 | Train Acc 0.7375 | Val Acc 0.7190
Task 0 Epoch 14/30 | Loss 0.4869 | Train Acc 0.7432 | Val Acc 0.7190
Task 0 Epoch 15/30 | Loss 0.4850 | Train Acc 0.7396 | Val Acc 0.7190
Task 0 Epoch 16/30 | Loss 0.4732 | Train Acc 0.7536 | Val Acc 0.7190
Task 0 Epoch 17/30 | Loss 0.4594 | Train Acc 0.7585 | Val Acc 0.7190
Task 0 Epoch 18/30 | Loss 0.4425 | Train Acc 0.7709 | Val Acc 0.7190
Task 0 Epoch 19/30 | Loss 0.4458 | Train Acc 0.7652 | Val Acc 0.7190
Task 0 Epoch 20/30 | Loss 0.4198 | Train Acc 0.7874 | Val Acc 0.7190
---- Eval at Epoch 20: [0.780952380952381, 0.0] ----
Task 0 Epoch 21/30 | Loss 0.4200 | Train Acc 0.7854 | Val Acc 0.7810
Task 0 Epoch 22/30 | Loss 0.4134 | Train Acc 0.7928 | Val Acc 0.7810
Task 0 Epoch 23/30 | Loss 0.4039 | Train Acc 0.7932 | Val Acc 0.7810
Task 0 Epoch 24/30 | Loss 0.3870 | Train Acc 0.8035 | Val Acc 0.7810
Task 0 Epoch 25/30 | Loss 0.3818 | Train Acc 0.8074 | Val Acc 0.7810
Task 0 Epoch 26/30 | Loss 0.3832 | Train Acc 0.8107 | Val Acc 0.7810
Task 0 Epoch 27/30 | Loss 0.3689 | Train Acc 0.8188 | Val Acc 0.7810
Task 0 Epoch 28/30 | Loss 0.3637 | Train Acc 0.8180 | Val Acc 0.7810
Task 0 Epoch 29/30 | Loss 0.3594 | Train Acc 0.8268 | Val Acc 0.7810
Task 0 Epoch 30/30 | Loss 0.3535 | Train Acc 0.8260 | Val Acc 0.7810
---- Eval at Epoch 0: [0.8464285714285714, 0.0] ----
Task 1 Epoch 1/30 | Loss 0.7343 | Train Acc 0.6414 | Val Acc 0.0000
Task 1 Epoch 2/30 | Loss 0.6404 | Train Acc 0.6844 | Val Acc 0.0000
Task 1 Epoch 3/30 | Loss 0.6136 | Train Acc 0.7051 | Val Acc 0.0000
Task 1 Epoch 4/30 | Loss 0.5887 | Train Acc 0.7187 | Val Acc 0.0000
Task 1 Epoch 5/30 | Loss 0.5600 | Train Acc 0.7362 | Val Acc 0.0000
Task 1 Epoch 6/30 | Loss 0.5489 | Train Acc 0.7426 | Val Acc 0.0000
Task 1 Epoch 7/30 | Loss 0.5337 | Train Acc 0.7523 | Val Acc 0.0000
Task 1 Epoch 8/30 | Loss 0.5001 | Train Acc 0.7716 | Val Acc 0.0000
Task 1 Epoch 9/30 | Loss 0.4757 | Train Acc 0.7897 | Val Acc 0.0000
Task 1 Epoch 10/30 | Loss 0.4489 | Train Acc 0.8030 | Val Acc 0.0000
---- Eval at Epoch 10: [0.7579365079365079, 0.059126984126984125] ----
Task 1 Epoch 11/30 | Loss 0.4179 | Train Acc 0.8201 | Val Acc 0.0591
Task 1 Epoch 12/30 | Loss 0.4001 | Train Acc 0.8307 | Val Acc 0.0591
Task 1 Epoch 13/30 | Loss 0.3748 | Train Acc 0.8401 | Val Acc 0.0591
Task 1 Epoch 14/30 | Loss 0.3619 | Train Acc 0.8424 | Val Acc 0.0591
Task 1 Epoch 15/30 | Loss 0.3513 | Train Acc 0.8482 | Val Acc 0.0591
Task 1 Epoch 16/30 | Loss 0.3437 | Train Acc 0.8495 | Val Acc 0.0591
Task 1 Epoch 17/30 | Loss 0.3193 | Train Acc 0.8626 | Val Acc 0.0591
Task 1 Epoch 18/30 | Loss 0.3089 | Train Acc 0.8705 | Val Acc 0.0591
Task 1 Epoch 19/30 | Loss 0.2902 | Train Acc 0.8779 | Val Acc 0.0591
Task 1 Epoch 20/30 | Loss 0.2884 | Train Acc 0.8744 | Val Acc 0.0591
---- Eval at Epoch 20: [0.7277777777777777, 0.42857142857142855] ----
Task 1 Epoch 21/30 | Loss 0.2744 | Train Acc 0.8839 | Val Acc 0.4286
Task 1 Epoch 22/30 | Loss 0.2653 | Train Acc 0.8875 | Val Acc 0.4286
Task 1 Epoch 23/30 | Loss 0.2583 | Train Acc 0.8918 | Val Acc 0.4286
Task 1 Epoch 24/30 | Loss 0.2512 | Train Acc 0.8974 | Val Acc 0.4286
Task 1 Epoch 25/30 | Loss 0.2384 | Train Acc 0.9048 | Val Acc 0.4286
Task 1 Epoch 26/30 | Loss 0.2187 | Train Acc 0.9109 | Val Acc 0.4286
Task 1 Epoch 27/30 | Loss 0.2210 | Train Acc 0.9122 | Val Acc 0.4286
Task 1 Epoch 28/30 | Loss 0.2181 | Train Acc 0.9116 | Val Acc 0.4286
Task 1 Epoch 29/30 | Loss 0.2032 | Train Acc 0.9193 | Val Acc 0.4286
Task 1 Epoch 30/30 | Loss 0.2044 | Train Acc 0.9199 | Val Acc 0.4286
####Final Validation Accuracy####
Final Results:- 
 Total Accuracy: 0.5662698412698413 
 Individual Accuracy: [0.45634920634920634, 0.6761904761904762]
####Final Test Accuracy####
Final Results:- 
 Total Accuracy: 0.5662698412698413 
 Individual Accuracy: [0.45634920634920634, 0.6761904761904762]
logs//agem/all_agem-2025-12-02_16-31-58-3074/0/results: {'expt_name': 'all_agem', 'model': 'agem', 'arch': 'resnet1d', 'n_hiddens': 100, 'n_layers': 2, 'xav_init': False, 'glances': 1, 'n_epochs': 30, 'batch_size': 128, 'replay_batch_size': 20, 'memories': 5120, 'lr': 0.03, 'cuda': True, 'seed': 0, 'log_every': 3125, 'log_dir': 'logs//agem/all_agem-2025-12-02_16-31-58-3074/0', 'tf_dir': 'logs//agem/all_agem-2025-12-02_16-31-58-3074/0/tfdir', 'calc_test_accuracy': True, 'data_path': 'data/rff/rfmls/', 'loader': 'task_incremental_loader', 'samples_per_task': -1, 'shuffle_tasks': False, 'classes_per_it': 4, 'iterations': 5000, 'dataset': 'iq', 'workers': 3, 'validation': 0.3, 'class_order': 'random', 'increment': 5, 'test_batch_size': 100000, 'nc_per_task': 5, 'val_rate': 10, 'opt_lr': 0.1, 'opt_wt': 0.1, 'alpha_init': 0.001, 'learn_lr': False, 'sync_update': False, 'grad_clip_norm': 2.0, 'cifar_batches': 3, 'use_old_task_memory': False, 'second_order': False, 'n_memories': 200, 'memory_strength': 0.5, 'steps_per_sample': 1, 'gamma': 1.0, 'beta': 1.0, 's': 1, 'batches_per_example': 1, 'bgd_optimizer': 'bgd', 'optimizer_params': '{}', 'train_mc_iters': 5, 'std_init': 0.05, 'mean_eta': 1, 'fisher_gamma': 0.95, 'rln': 7, 'update_steps': 10, 'meta_lr': 0.001, 'update_lr': 0.1, 'ctn_lr': 0.01, 'ctn_beta': 0.05, 'ctn_n_meta': 2, 'ctn_inner_steps': 2, 'ctn_temperature': 5, 'ctn_n_memories': 50, 'ctn_alpha_init': 0.1, 'ctn_memory_strength': 0.5, 'ctn_task_emb': 64, 'bcl_n_memories': 2000, 'bcl_memory_strength': 1.0, 'bcl_temperature': 2.0, 'bcl_inner_steps': 5, 'bcl_n_meta': 5, 'bcl_adapt_lr': 0.1} # val: 0.761 0.566 -0.195 -0.080 # test: 0.761 0.566 -0.195 0.000 # 471.37869668006897

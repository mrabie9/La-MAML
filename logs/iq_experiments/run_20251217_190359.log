python3 -u main.py $IQ --model lamaml_cifar --expt_name all_lamaml_sync --memories 1024 --batch_size 128 --replay_batch_size 64 --n_epochs 5 
                    --opt_lr 0.35 --alpha_init 0.1 --opt_wt 0.1 --glances 1  --increment 5 
                    --cifar_batches 5 --learn_lr --sync_update --log_every 3125 --second_order --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3 --samples_per_task -1

python3 -u main.py $IQ --model lamaml_cifar --expt_name all_cmaml --memories 1024 --batch_size 128 --replay_batch_size 64 --n_epochs 5 
                    --opt_lr 0.35 --alpha_init 0.075 --opt_wt 0.075 --glances 1  --increment 5 
                    --cifar_batches 5 --sync_update --log_every 3125 --second_order --class_order random 
                    --seed $SEED --calc_test_accuracy --validation 0.3 --samples_per_task -1

Logging IQ experiment suite to logs/iq_experiments/run_20251217_190359.log
New Experiment Starting...
Running model:  lamaml_cifar
[STATE 2025-12-17 19:04:01] Experiment 'all_lamaml_sync' starting with model 'lamaml_cifar' (seed 0)
Set seed 0
Loaded task0.npz: Unique train labels: [0 1 2 3 4 5]
Loaded task0.npz: Remapped labels: [0 1 2 3 4 5]. Size: 190940)
Loaded task1.npz: Unique train labels: [ 0  6  7  8  9 10]
Loaded task1.npz: Remapped labels: [ 6  7  8  9 10 11]. Size: 379500)
[STATE 2025-12-17 19:04:06] Loader 'task_incremental_loader' ready: 1024 inputs, 12 outputs, 2 tasks
n_outputs: 12 	n_tasks: 2
[STATE 2025-12-17 19:04:06] Logging to logs//lamaml_cifar/all_lamaml_sync-2025-12-17_19-04-06-0361/0
True
Model device: cuda:0
[STATE 2025-12-17 19:04:06] Model initialized on device cuda:0
[STATE 2025-12-17 19:04:06] Invoking continual life experience flow
[STATE 2025-12-17 19:04:06] Life experience start: 2 tasks queued
[STATE 2025-12-17 19:04:06] Starting task 0 (1/2)
[STATE 2025-12-17 19:04:06] Task 0 Epoch 1/5: entering train loop
[STATE 2025-12-17 19:04:06] Task 0 Epoch 1/5 Iter 0: running validation
---- Eval at Epoch 0: [0.1729599952005104, 0.02205733843349419] ----
Task 0 Epoch 1/5 | Loss 0.0759 | Train Acc 0.8309 | Val Acc 0.1730 | Epoch Time 2299.92s (Eval 42.59s, Train 2257.33s)
[STATE 2025-12-17 19:42:26] Task 0 Epoch 1/5 complete: 2299.92s total (42.59s eval/2257.33s train)
[STATE 2025-12-17 19:42:26] Task 0 Epoch 2/5: entering train loop
Task 0 Epoch 2/5 | Loss 0.0198 | Train Acc 0.9517 | Val Acc 0.1730 | Epoch Time 2252.85s (Eval 0.00s, Train 2252.85s)
[STATE 2025-12-17 20:19:59] Task 0 Epoch 2/5 complete: 2252.85s total (0.00s eval/2252.85s train)
[STATE 2025-12-17 20:19:59] Task 0 Epoch 3/5: entering train loop
Task 0 Epoch 3/5 | Loss 0.0151 | Train Acc 0.9639 | Val Acc 0.1730 | Epoch Time 2252.53s (Eval 0.00s, Train 2252.53s)
[STATE 2025-12-17 20:57:31] Task 0 Epoch 3/5 complete: 2252.53s total (0.00s eval/2252.53s train)
[STATE 2025-12-17 20:57:31] Task 0 Epoch 4/5: entering train loop
Task 0 Epoch 4/5 | Loss 0.0131 | Train Acc 0.9668 | Val Acc 0.1730 | Epoch Time 2249.75s (Eval 0.00s, Train 2249.75s)
[STATE 2025-12-17 21:35:01] Task 0 Epoch 4/5 complete: 2249.75s total (0.00s eval/2249.75s train)
[STATE 2025-12-17 21:35:01] Task 0 Epoch 5/5: entering train loop
Task 0 Epoch 5/5 | Loss 0.0115 | Train Acc 0.9713 | Val Acc 0.1730 | Epoch Time 2251.24s (Eval 0.00s, Train 2251.24s)
[STATE 2025-12-17 22:12:32] Task 0 Epoch 5/5 complete: 2251.24s total (0.00s eval/2251.24s train)
[STATE 2025-12-17 22:12:32] Task 0: running final validation.
[STATE 2025-12-17 22:14:40] Completed task 0 (1/2)
[STATE 2025-12-17 22:14:41] Starting task 1 (2/2)
[STATE 2025-12-17 22:14:41] Task 1 Epoch 1/5: entering train loop
[STATE 2025-12-17 22:14:41] Task 1 Epoch 1/5 Iter 0: running validation
---- Eval at Epoch 0: [0.8873442699883886, 0.021786789949957756] ----
Task 1 Epoch 1/5 | Loss 0.0235 | Train Acc 0.9306 | Val Acc 0.0218 | Epoch Time 4599.97s (Eval 42.73s, Train 4557.24s)
[STATE 2025-12-17 23:31:21] Task 1 Epoch 1/5 complete: 4599.97s total (42.73s eval/4557.24s train)
[STATE 2025-12-17 23:31:21] Task 1 Epoch 2/5: entering train loop
Task 1 Epoch 2/5 | Loss 0.0115 | Train Acc 0.9584 | Val Acc 0.0218 | Epoch Time 4552.94s (Eval 0.00s, Train 4552.94s)
[STATE 2025-12-18 00:47:14] Task 1 Epoch 2/5 complete: 4552.94s total (0.00s eval/4552.94s train)
[STATE 2025-12-18 00:47:14] Task 1 Epoch 3/5: entering train loop
Task 1 Epoch 3/5 | Loss 0.0096 | Train Acc 0.9629 | Val Acc 0.0218 | Epoch Time 4545.98s (Eval 0.00s, Train 4545.98s)
[STATE 2025-12-18 02:03:00] Task 1 Epoch 3/5 complete: 4545.98s total (0.00s eval/4545.98s train)
[STATE 2025-12-18 02:03:00] Task 1 Epoch 4/5: entering train loop
Task 1 Epoch 4/5 | Loss 0.0084 | Train Acc 0.9664 | Val Acc 0.0218 | Epoch Time 4551.27s (Eval 0.00s, Train 4551.27s)
[STATE 2025-12-18 03:18:51] Task 1 Epoch 4/5 complete: 4551.27s total (0.00s eval/4551.27s train)
[STATE 2025-12-18 03:18:51] Task 1 Epoch 5/5: entering train loop
Task 1 Epoch 5/5 | Loss 0.0077 | Train Acc 0.9693 | Val Acc 0.0218 | Epoch Time 4557.69s (Eval 0.00s, Train 4557.69s)
[STATE 2025-12-18 04:34:49] Task 1 Epoch 5/5 complete: 4557.69s total (0.00s eval/4557.69s train)
[STATE 2025-12-18 04:34:49] Task 1: running final validation.
[STATE 2025-12-18 04:36:57] Completed task 1 (2/2)
####Final Validation Accuracy####
Final Results:- 
 Total Accuracy: 0.4204733927479749 
 Individual Accuracy: [0.6752536542708724, 0.16569313122507745]
####Final Test Accuracy####
Final Results:- 
 Total Accuracy: 0.4204733927479749 
 Individual Accuracy: [0.6752536542708724, 0.16569313122507745]
[STATE 2025-12-18 04:36:57] Saving results to logs//lamaml_cifar/all_lamaml_sync-2025-12-17_19-04-06-0361/0/results
logs//lamaml_cifar/all_lamaml_sync-2025-12-17_19-04-06-0361/0/results: {'expt_name': 'all_lamaml_sync', 'model': 'lamaml_cifar', 'arch': 'resnet1d', 'n_hiddens': 100, 'n_layers': 2, 'xav_init': False, 'glances': 1, 'n_epochs': 5, 'batch_size': 128, 'replay_batch_size': 64.0, 'memories': 1024, 'lr': 0.001, 'cuda': True, 'seed': 0, 'log_every': 3125, 'log_dir': 'logs//lamaml_cifar/all_lamaml_sync-2025-12-17_19-04-06-0361/0', 'tf_dir': 'logs//lamaml_cifar/all_lamaml_sync-2025-12-17_19-04-06-0361/0/tfdir', 'calc_test_accuracy': True, 'state_logging': True, 'data_path': 'data/rff/radar/', 'loader': 'task_incremental_loader', 'samples_per_task': -1, 'shuffle_tasks': False, 'classes_per_it': 4, 'iterations': 5000, 'dataset': 'iq', 'workers': 3, 'validation': 0.3, 'class_order': 'random', 'increment': 5, 'test_batch_size': 100000, 'nc_per_task': 5, 'val_rate': 10, 'opt_lr': 0.35, 'opt_wt': 0.1, 'alpha_init': 0.1, 'learn_lr': True, 'sync_update': True, 'grad_clip_norm': 2.0, 'cifar_batches': 5, 'use_old_task_memory': False, 'second_order': True, 'n_memories': 0, 'memory_strength': 0, 'steps_per_sample': 1, 'gamma': 1.0, 'beta': 1.0, 's': 1, 'batches_per_example': 1, 'bgd_optimizer': 'bgd', 'optimizer_params': '{}', 'train_mc_iters': 5, 'std_init': 0.05, 'mean_eta': 1, 'fisher_gamma': 0.95, 'rln': 7, 'update_steps': 10, 'meta_lr': 0.001, 'update_lr': 0.1, 'ctn_lr': 0.01, 'ctn_beta': 0.05, 'ctn_n_meta': 2, 'ctn_inner_steps': 2, 'ctn_temperature': 5, 'ctn_n_memories': 50, 'ctn_alpha_init': 0.1, 'ctn_memory_strength': 0.5, 'ctn_task_emb': 64, 'bcl_n_memories': 2000, 'bcl_memory_strength': 1.0, 'bcl_temperature': 2.0, 'bcl_inner_steps': 5, 'bcl_n_meta': 5, 'bcl_adapt_lr': 0.1} # val: 0.527 0.420 -0.106 -0.000 # test: 0.527 0.420 -0.106 0.000 # 34371.10381245613
[STATE 2025-12-18 04:36:57] Results saved; total runtime 34371.10s
New Experiment Starting...
Running model:  lamaml_cifar
[STATE 2025-12-18 04:37:00] Experiment 'all_cmaml' starting with model 'lamaml_cifar' (seed 0)
Set seed 0
Loaded task0.npz: Unique train labels: [0 1 2 3 4 5]
Loaded task0.npz: Remapped labels: [0 1 2 3 4 5]. Size: 190940)
Loaded task1.npz: Unique train labels: [ 0  6  7  8  9 10]
Loaded task1.npz: Remapped labels: [ 6  7  8  9 10 11]. Size: 379500)
[STATE 2025-12-18 04:37:04] Loader 'task_incremental_loader' ready: 1024 inputs, 12 outputs, 2 tasks
n_outputs: 12 	n_tasks: 2
[STATE 2025-12-18 04:37:04] Logging to logs//lamaml_cifar/all_cmaml-2025-12-18_04-37-04-6425/0
True
Model device: cuda:0
[STATE 2025-12-18 04:37:04] Model initialized on device cuda:0
[STATE 2025-12-18 04:37:04] Invoking continual life experience flow
[STATE 2025-12-18 04:37:04] Life experience start: 2 tasks queued
[STATE 2025-12-18 04:37:04] Starting task 0 (1/2)
[STATE 2025-12-18 04:37:04] Task 0 Epoch 1/5: entering train loop
[STATE 2025-12-18 04:37:04] Task 0 Epoch 1/5 Iter 0: running validation
---- Eval at Epoch 0: [0.1729599952005104, 0.02205733843349419] ----
Task 0 Epoch 1/5 | Loss 0.0775 | Train Acc 0.8292 | Val Acc 0.1730 | Epoch Time 2293.67s (Eval 42.79s, Train 2250.88s)
[STATE 2025-12-18 05:15:18] Task 0 Epoch 1/5 complete: 2293.67s total (42.79s eval/2250.88s train)
[STATE 2025-12-18 05:15:18] Task 0 Epoch 2/5: entering train loop
Task 0 Epoch 2/5 | Loss 0.0192 | Train Acc 0.9507 | Val Acc 0.1730 | Epoch Time 2250.08s (Eval 0.00s, Train 2250.08s)
[STATE 2025-12-18 05:52:48] Task 0 Epoch 2/5 complete: 2250.08s total (0.00s eval/2250.08s train)
[STATE 2025-12-18 05:52:48] Task 0 Epoch 3/5: entering train loop
Task 0 Epoch 3/5 | Loss 0.0143 | Train Acc 0.9646 | Val Acc 0.1730 | Epoch Time 2251.64s (Eval 0.00s, Train 2251.64s)
[STATE 2025-12-18 06:30:20] Task 0 Epoch 3/5 complete: 2251.64s total (0.00s eval/2251.64s train)
[STATE 2025-12-18 06:30:20] Task 0 Epoch 4/5: entering train loop
Task 0 Epoch 4/5 | Loss 0.0122 | Train Acc 0.9668 | Val Acc 0.1730 | Epoch Time 2249.64s (Eval 0.00s, Train 2249.64s)
[STATE 2025-12-18 07:07:49] Task 0 Epoch 4/5 complete: 2249.64s total (0.00s eval/2249.64s train)
[STATE 2025-12-18 07:07:49] Task 0 Epoch 5/5: entering train loop
Task 0 Epoch 5/5 | Loss 0.0104 | Train Acc 0.9719 | Val Acc 0.1730 | Epoch Time 2251.54s (Eval 0.00s, Train 2251.54s)
[STATE 2025-12-18 07:45:21] Task 0 Epoch 5/5 complete: 2251.54s total (0.00s eval/2251.54s train)
[STATE 2025-12-18 07:45:21] Task 0: running final validation.
[STATE 2025-12-18 07:47:29] Completed task 0 (1/2)
[STATE 2025-12-18 07:47:30] Starting task 1 (2/2)
[STATE 2025-12-18 07:47:30] Task 1 Epoch 1/5: entering train loop
[STATE 2025-12-18 07:47:30] Task 1 Epoch 1/5 Iter 0: running validation
---- Eval at Epoch 0: [0.8935555202981463, 0.014156716765532727] ----
Task 1 Epoch 1/5 | Loss 0.0207 | Train Acc 0.9293 | Val Acc 0.0142 | Epoch Time 4585.46s (Eval 42.71s, Train 4542.75s)
[STATE 2025-12-18 09:03:55] Task 1 Epoch 1/5 complete: 4585.46s total (42.71s eval/4542.75s train)
[STATE 2025-12-18 09:03:55] Task 1 Epoch 2/5: entering train loop
Task 1 Epoch 2/5 | Loss 0.0116 | Train Acc 0.9586 | Val Acc 0.0142 | Epoch Time 4538.94s (Eval 0.00s, Train 4538.94s)
[STATE 2025-12-18 10:19:34] Task 1 Epoch 2/5 complete: 4538.94s total (0.00s eval/4538.94s train)
[STATE 2025-12-18 10:19:34] Task 1 Epoch 3/5: entering train loop
Task 1 Epoch 3/5 | Loss 0.0094 | Train Acc 0.9633 | Val Acc 0.0142 | Epoch Time 4550.30s (Eval 0.00s, Train 4550.30s)
[STATE 2025-12-18 11:35:24] Task 1 Epoch 3/5 complete: 4550.30s total (0.00s eval/4550.30s train)
[STATE 2025-12-18 11:35:24] Task 1 Epoch 4/5: entering train loop
Task 1 Epoch 4/5 | Loss 0.0083 | Train Acc 0.9670 | Val Acc 0.0142 | Epoch Time 4535.58s (Eval 0.00s, Train 4535.58s)
[STATE 2025-12-18 12:51:00] Task 1 Epoch 4/5 complete: 4535.58s total (0.00s eval/4535.58s train)
[STATE 2025-12-18 12:51:00] Task 1 Epoch 5/5: entering train loop
Task 1 Epoch 5/5 | Loss 0.0076 | Train Acc 0.9703 | Val Acc 0.0142 | Epoch Time 4544.52s (Eval 0.00s, Train 4544.52s)
[STATE 2025-12-18 14:06:44] Task 1 Epoch 5/5 complete: 4544.52s total (0.00s eval/4544.52s train)
[STATE 2025-12-18 14:06:44] Task 1: running final validation.
[STATE 2025-12-18 14:08:52] Completed task 1 (2/2)
####Final Validation Accuracy####
Final Results:- 
 Total Accuracy: 0.4345963936145206 
 Individual Accuracy: [0.7454683083892165, 0.12372447883982478]
####Final Test Accuracy####
Final Results:- 
 Total Accuracy: 0.4345963936145206 
 Individual Accuracy: [0.7454683083892165, 0.12372447883982478]
[STATE 2025-12-18 14:08:52] Saving results to logs//lamaml_cifar/all_cmaml-2025-12-18_04-37-04-6425/0/results
logs//lamaml_cifar/all_cmaml-2025-12-18_04-37-04-6425/0/results: {'expt_name': 'all_cmaml', 'model': 'lamaml_cifar', 'arch': 'resnet1d', 'n_hiddens': 100, 'n_layers': 2, 'xav_init': False, 'glances': 1, 'n_epochs': 5, 'batch_size': 128, 'replay_batch_size': 64.0, 'memories': 1024, 'lr': 0.001, 'cuda': True, 'seed': 0, 'log_every': 3125, 'log_dir': 'logs//lamaml_cifar/all_cmaml-2025-12-18_04-37-04-6425/0', 'tf_dir': 'logs//lamaml_cifar/all_cmaml-2025-12-18_04-37-04-6425/0/tfdir', 'calc_test_accuracy': True, 'state_logging': True, 'data_path': 'data/rff/radar/', 'loader': 'task_incremental_loader', 'samples_per_task': -1, 'shuffle_tasks': False, 'classes_per_it': 4, 'iterations': 5000, 'dataset': 'iq', 'workers': 3, 'validation': 0.3, 'class_order': 'random', 'increment': 5, 'test_batch_size': 100000, 'nc_per_task': 5, 'val_rate': 10, 'opt_lr': 0.35, 'opt_wt': 0.075, 'alpha_init': 0.075, 'learn_lr': False, 'sync_update': True, 'grad_clip_norm': 2.0, 'cifar_batches': 5, 'use_old_task_memory': False, 'second_order': True, 'n_memories': 0, 'memory_strength': 0, 'steps_per_sample': 1, 'gamma': 1.0, 'beta': 1.0, 's': 1, 'batches_per_example': 1, 'bgd_optimizer': 'bgd', 'optimizer_params': '{}', 'train_mc_iters': 5, 'std_init': 0.05, 'mean_eta': 1, 'fisher_gamma': 0.95, 'rln': 7, 'update_steps': 10, 'meta_lr': 0.001, 'update_lr': 0.1, 'ctn_lr': 0.01, 'ctn_beta': 0.05, 'ctn_n_meta': 2, 'ctn_inner_steps': 2, 'ctn_temperature': 5, 'ctn_n_memories': 50, 'ctn_alpha_init': 0.1, 'ctn_memory_strength': 0.5, 'ctn_task_emb': 64, 'bcl_n_memories': 2000, 'bcl_memory_strength': 1.0, 'bcl_temperature': 2.0, 'bcl_inner_steps': 5, 'bcl_n_meta': 5, 'bcl_adapt_lr': 0.1} # val: 0.509 0.435 -0.074 -0.004 # test: 0.509 0.435 -0.074 0.000 # 34308.180557727814
[STATE 2025-12-18 14:08:53] Results saved; total runtime 34308.18s
